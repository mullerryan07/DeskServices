unit MedicalCodes_u;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ComCtrls;

type
  TfrmMedicalCodes = class(TForm)
    lblHeading: TLabel;
    tvCodes: TTreeView;
    redText: TRichEdit;
    btnClose: TButton;
    procedure ItemClicked(Sender: TObject);
    procedure btnCloseClick(Sender: TObject);
  private
    { Private declarations }
  public
    procedure ShowScreen;
  end;

var
  frmMedicalCodes: TfrmMedicalCodes;

implementation

uses
Dashboard_u, Init_u;

{$R *.dfm}

procedure TfrmMedicalCodes.btnCloseClick(Sender: TObject);
begin

  // Close the Screen
  frmMedicalCodes.Close;

end;

procedure TfrmMedicalCodes.ItemClicked(Sender: TObject);
begin

  // Clear redText
  redText.Clear;

  // Extract the Code that was selected
  var sCode : string := tvCodes.Selected.Text;

  // If the ICD-10 Codes heading was selected.
  if tvCodes.Selected.Text = 'ICD-10 Codes' then
  begin

    redText.Clear;
    redText.Lines.Add('ICD-10 Codes Viewer');

    Exit;

  end;

  // If an ICD-10 Code was selected

  redText.Lines.Add('ICD-10 Code Index');

  Init.tblICD.First;

  while not Init.tblICD.Eof do
  begin

    if Init.tblICD['ICDCode'] = sCode then
    begin

      redText.Lines.Add('Selected Code:' + #13 + sCode);
      redText.Lines.Add('Code Description:' + #13 + Init.tblICD['ICDDescription']);

    end;

    Init.tblICD.Next;

  end;

end;

procedure TfrmMedicalCodes.ShowScreen;
begin

  // Clear TreeView
  tvCodes.Items.Clear;

  // Add the ICD-10 Codes
  Init.tblICD.First;

  while not Init.tblICD.Eof do
  begin

    tvCodes.Items.Add(nil, Init.tblICD['ICDCode']);

    Init.tblICD.Next;

  end;

  // Show Screen
  frmMedicalCodes.Parent := frmDashboard;
  frmMedicalCodes.Show;

end;

end.
